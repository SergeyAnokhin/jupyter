{
  "aggs": {
    "2": {
      "aggs": {
        "1": { "avg": { "field": "value" } },
        "3": {
          "aggs": { "1": { "avg": { "field": "value" } } },
          "date_range": {
            "field": "@timestamp",
            "ranges": [
              { "from": "2017-12-02T13:15:00", "to": "2017-12-02T18:12:00" },
              { "from": "2017-12-02T18:12:00", "to": "2017-12-03T16:31:00" },
              { "from": "2017-12-03T16:31:00", "to": "2017-12-03T19:48:00" },
              { "from": "2017-12-03T19:48:00", "to": "2017-12-03T23:23:00" },
              { "from": "2017-12-03T23:23:00", "to": "2017-12-04T19:31:00" },
              { "from": "2017-12-04T19:31:00", "to": "2017-12-05T19:30:00" },
              { "from": "2017-12-05T19:30:00", "to": "2017-12-06T08:40:00" },
              { "from": "2017-12-06T08:40:00", "to": "2017-12-06T09:59:00" },
              { "from": "2017-12-06T09:59:00", "to": "2017-12-06T10:45:00" },
              { "from": "2017-12-06T10:45:00", "to": "2017-12-06T14:53:00" },
              { "from": "2017-12-06T14:53:00", "to": "2017-12-06T19:13:00" },
              { "from": "2017-12-06T19:13:00", "to": "2017-12-08T01:02:00" },
              { "from": "2017-12-08T01:02:00", "to": "2017-12-08T19:42:00" },
              { "from": "2017-12-08T19:42:00", "to": "2017-12-09T20:38:00" },
              { "from": "2017-12-09T20:38:00", "to": "2017-12-10T20:25:00" },
              { "from": "2017-12-10T20:25:00", "to": "2017-12-11T07:43:00" },
              { "from": "2017-12-11T07:43:00", "to": "2017-12-11T19:54:00" },
              { "from": "2017-12-11T19:54:00", "to": "2017-12-12T07:41:00" },
              { "from": "2017-12-12T07:41:00", "to": "2017-12-12T19:48:00" },
              { "from": "2017-12-12T19:48:00", "to": "2017-12-13T07:44:00" },
              { "from": "2017-12-13T07:44:00", "to": "2017-12-13T20:13:00" },
              { "from": "2017-12-13T20:13:00", "to": "2017-12-14T19:43:00" },
              { "from": "2017-12-14T19:43:00", "to": "2017-12-14T23:51:00" },
              { "from": "2017-12-14T23:51:00", "to": "2017-12-15T19:12:00" },
              { "from": "2017-12-15T19:12:00", "to": "2017-12-16T10:06:00" },
              { "from": "2017-12-16T10:06:00", "to": "2017-12-27T01:07:00" },
              { "from": "2017-12-27T01:07:00", "to": "2017-12-27T01:52:00" },
              { "from": "2017-12-27T01:52:00", "to": "2017-12-27T07:53:00" },
              { "from": "2017-12-27T07:53:00", "to": "2017-12-27T19:13:00" },
              { "from": "2017-12-27T19:13:00", "to": "2017-12-28T07:38:00" },
              { "from": "2017-12-28T07:38:00", "to": "2017-12-28T19:45:00" },
              { "from": "2017-12-28T19:45:00", "to": "2017-12-29T19:18:00" },
              { "from": "2017-12-29T19:18:00", "to": "2017-12-30T18:31:00" },
              { "from": "2017-12-30T18:31:00", "to": "2017-12-31T20:48:00" },
              { "from": "2017-12-31T20:48:00", "to": "2018-01-01T20:00:00" },
              { "from": "2018-01-01T20:00:00", "to": "2018-01-02T19:26:00" },
              { "from": "2018-01-02T19:26:00", "to": "2018-01-03T19:02:00" },
              { "from": "2018-01-03T19:02:00", "to": "2018-01-04T19:13:00" },
              { "from": "2018-01-04T19:13:00", "to": "2018-01-05T19:33:00" }
            ]
          }
        }
      },
      "terms": {
        "field": "sensor.display.keyword",
        "order": { "1": "desc" },
        "size": 10
      }
    }
  },
  "query": {
    "bool": {
      "must": [
        {
          "bool": {
            "minimum_should_match": 1,
            "should": [
              { "match_phrase": { "sensor.display": "WoodSouth(2) Battery" } },
              { "match_phrase": { "sensor.display": "WoodNorth(2) Battery" } },
              { "match_phrase": { "sensor.display": "Stairs(2) Battery" } },
              { "match_phrase": { "sensor.display": "White(2) Battery" } },
              { "match_phrase": { "sensor.display": "Boiler(0) Pipe MA" } },
              { "match_phrase": { "sensor.display": "Villebon(.) Station" } }
            ]
          }
        },
        { "match_phrase": { "sensor.type": { "query": "Temp" } } }
      ]
    }
  },
  "size": 0
}
